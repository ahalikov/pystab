#labels Featured,Phase-Design
=Логика работы form_lagranges_equations()=

Функция form_lagranges_equations() составляет и возвращает уравнения движения в форме Лагранжа. Если dhc_matrix определена, =>, система неголономная и возвращаются уравнения Лагранжа первого рода. В случае, когда dhc_matrix не определена, система является голономной и логично ожидать, что функция будет возвращать уравнения Лагранжа второго рода. Однако на деле возвращаются только левые части уравнений движения без учета обобщенных сил (joint_forces). Конечно, можно возразить - обобщенные силы сидят в лагранжиане. А я вот столкнулась с примером, в котором есть реакции связи. Честно записываю их с помощью add_joint_forces(), а получаю не совсем доделанные уравнения. Может, стоит в form_lagranges_equations() передавать параметр? Типа если 0 - дефолтное значение, то не учитывай joint_forces, все нужное сидит в лагранжиане. Если 1 - учитывай joint_forces.